<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https://kqjcorjjvunmyrnzvqgr.supabase.co; style-src 'self' 'unsafe-inline'; connect-src 'self' https://kqjcorjjvunmyrnzvqgr.supabase.co wss://kqjcorjjvunmyrnzvqgr.supabase.co; img-src 'self' data: https:; font-src 'self'; object-src 'none'; base-uri 'self'; form-action 'self'; upgrade-insecure-requests">

    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-XSS-Protection" content="1; mode=block">
    <meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin">
    <title>Account - Anchored</title>
    <link rel="stylesheet" href="css/main.css?v=20250904c">
    <link rel="stylesheet" href="css/components.css?v=20250904c">
    <link rel="stylesheet" href="css/responsive.css?v=20250904c">
</head>
<body>
    <div class="app-container">
        <!-- Navigation Header -->
        <header class="nav-header">
            <div class="nav-content">
                <div class="logo">
                    <h1>Anchored</h1>
                </div>
                <nav class="nav-links">
                    <a href="dashboard.html" class="nav-link">Dashboard</a>
                    <button id="logoutBtn" class="nav-link btn-secondary">Logout</button>
                </nav>
            </div>
        </header>

        <!-- Account Content -->
        <main class="account-main">
            <div class="account-container">
                <h2>Account Settings</h2>

                <!-- Account Information -->
                <section class="account-section">
                    <h3>Account Information</h3>
                    <div class="account-info">
                        <div class="info-item">
                            <label>Email</label>
                            <span id="userEmail">Loading...</span>
                        </div>
                        <div class="info-item">
                            <label>Account Created</label>
                            <span id="accountCreated">Loading...</span>
                        </div>
                    </div>
                </section>

                <!-- Subscription Management -->
                <section class="account-section">
                    <h3>Subscription</h3>
                    <div class="subscription-info">
                        <div class="subscription-status" id="subscriptionStatus">
                            <div class="status-badge" id="statusBadge">Free</div>
                            <div class="status-details">
                                <p id="statusDescription">You're on the free plan</p>
                                <p id="statusExpiry" class="hidden">Expires: <span id="expiryDate"></span></p>
                            </div>
                        </div>
                        
                        <div class="subscription-actions">
                            <button id="upgradeBtn" class="btn-primary">Upgrade to Premium</button>
                            <button id="manageSubscriptionBtn" class="btn-secondary hidden">Manage Subscription</button>
                        </div>
                    </div>

                    <!-- Free Features -->
                    <div class="free-features">
                        <h4>Free Features (Always Available)</h4>
                        <ul>
                            <li>Browser extension with full functionality</li>
                            <li>Local note storage (unlimited)</li>
                            <li>Domain & page-specific organization</li>
                            <li>Multi-highlight mode for text selection</li>
                            <li>Context menu quick note creation</li>
                            <li>Rich text formatting (bold, italic, colors)</li>
                            <li>Tags and local search</li>
                            <li>Customizable keyboard shortcuts</li>
                            <li>Theme customization & font adjustment</li>
                            <li>Basic export (Plain Text format)</li>
                            <li>AI features (5 uses/month)</li>
                            <li>Version history (last 5 versions per note)</li>
                        </ul>
                    </div>

                    <!-- Premium Features -->
                    <div class="premium-features">
                        <h4>Premium Features ($2.50/month)</h4>
                        <ul>
                            <li>Cloud sync across all devices</li>
                            <li>Web application access</li>
                            <li>Advanced search and filtering (All Notes)</li>
                            <li>Unlimited version history for all notes</li>
                            <li>AI Rewrite with multiple styles (500 uses/month)</li>
                            <li>AI Summary for domain notes (500 uses/month)</li>
                            <li>All export formats (JSON, Markdown, Obsidian, Notion, Plain Text, Google Docs)</li>
                            <li>Import functionality</li>
                            <li>Ad-free experience</li>
                            <li>Priority support</li>
                        </ul>
                    </div>
                </section>

                <!-- Security Settings -->
                <section class="account-section">
                    <h3>Security</h3>
                    <div class="security-settings">
                        <button id="changePasswordBtn" class="btn-secondary">Change Password</button>
                        <p class="security-note">
                            Changing your password will re-encrypt all your notes with new encryption keys.
                        </p>
                    </div>
                </section>

                <!-- Data Management -->
                <section class="account-section">
                    <h3>Data Management</h3>
                    <div class="data-actions">
                        <button id="exportAllBtn" class="btn-secondary">Export All Data</button>
                        <button id="deleteAccountBtn" class="btn-danger">Delete Account</button>
                    </div>
                    <p class="data-note">
                        Export your data before deleting your account. This action cannot be undone.
                    </p>
                </section>
            </div>
        </main>

        <!-- Change Password Modal -->
        <div class="modal hidden" id="changePasswordModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Change Password</h3>
                    <button class="modal-close" id="closePasswordModal">&times;</button>
                </div>
                <div class="modal-body">
                    <form id="changePasswordForm">
                        <div class="input-group">
                            <input type="password" id="currentPassword" placeholder="Current Password" required>
                        </div>
                        <div class="input-group">
                            <input type="password" id="newPassword" placeholder="New Password" required>
                        </div>
                        <div class="input-group">
                            <input type="password" id="confirmNewPassword" placeholder="Confirm New Password" required>
                        </div>
                        <div class="modal-actions">
                            <button type="button" id="cancelPasswordChange" class="btn-secondary">Cancel</button>
                            <button type="submit" class="btn-primary">Change Password</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Subscription Modal -->
        <div class="modal hidden" id="subscriptionModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Upgrade to Premium</h3>
                    <button class="modal-close" id="closeSubscriptionModal">&times;</button>
                </div>
                <div class="modal-body">
                    <!-- Subscription interface will be implemented in task 5 -->
                    <p>Subscription management will be implemented in task 5.</p>
                </div>
            </div>
        </div>
    </div>

    <script src="config.js?v=20250904c"></script>
    <script src="js/lib/encryption.js?v=20250904c"></script>
    <script src="js/lib/api.js?v=20250904c"></script>
    <script src="js/auth.js?v=20250904c"></script>
    <script src="js/app.js?v=20250904c"></script>
    <script src="js/account.js?v=20250904c"></script>
    <script src="js/monitoring.js?v=20250904c"></script>
</body>
</html>