<!DOCTYPE html>
<html>
<head>
    <title>Export Test</title>
    <meta charset="UTF-8">
</head>
<body>
    <h1>URL Notes Export Test</h1>
    <p>This page tests the export functionality with sample data.</p>
    
    <div>
        <label for="formatSelect">Export Format:</label>
        <select id="formatSelect">
            <option value="json">JSON Backup</option>
            <option value="markdown">Markdown</option>
            <option value="obsidian">Obsidian</option>
            <option value="txt">Plain Text</option>
            <option value="notion">Notion</option>
            <option value="docx">Google Docs</option>
        </select>
        <button onclick="testExport()">Test Export</button>
    </div>
    
    <div id="output" style="margin-top: 20px; padding: 10px; border: 1px solid #ccc; background: #f9f9f9; white-space: pre-wrap; font-family: monospace; max-height: 400px; overflow-y: auto;"></div>

    <script src="extension/popup/modules/export-formats.js"></script>
    <script>
        // Sample data similar to the attached JSON file
        const sampleData = {
            "www.youtube.com": [
                {
                    "id": "3d8f8e16-4cb6-4253-b05f-052ed080d221",
                    "title": "encrypted note yes or no",
                    "content": "test note test encypted or not encrytped ot nor ",
                    "tags": ["test  encyrption here as well"],
                    "createdAt": "2025-09-01T15:53:48.094Z",
                    "updatedAt": "2025-09-01T15:54:12.783Z",
                    "domain": "www.youtube.com",
                    "url": "https://www.youtube.com/watch?v=Y8TLag5Y_f8",
                    "pageTitle": "„ÄêASMR„ÄëSLEEP IN 30 MINUTESüò¥| triggers and close whispersüíó | can you make it to the end‚ÅâÔ∏èüò™#3DIO #asmr - YouTube",
                    "title_encrypted": {
                        "encrypted": [40, 76, 33, 117, 254, 51, 151, 228, 180, 35, 200, 92, 167, 243, 34, 52, 154, 22, 231, 56, 196, 5, 207, 88, 102, 146, 45, 97, 154, 235, 14, 207, 203, 141, 146, 242, 123, 16, 115, 45],
                        "iv": [60, 37, 249, 236, 184, 9, 196, 10, 100, 39, 64, 53],
                        "algorithm": "AES-GCM"
                    },
                    "content_encrypted": {
                        "encrypted": [158, 169, 2, 209, 76, 186, 246, 133, 141, 25, 35, 98, 233, 238, 238, 216, 40, 76, 131, 237, 210, 113, 238, 84, 199, 36, 86, 132, 104, 109, 191, 141, 194, 25, 84, 12, 29, 119, 96, 114, 107, 160, 146, 205, 1, 200, 143, 109, 118, 237, 49, 224, 126, 166, 201, 218, 202, 166, 12, 168, 11, 117, 104, 222, 146],
                        "iv": [96, 188, 213, 174, 15, 184, 0, 46, 129, 82, 122, 165],
                        "algorithm": "AES-GCM"
                    },
                    "content_hash": "925bbad545fffb49fb5d46fc8e1085c62099fe9e2ba45256e2048d9d54b25956",
                    "version": 1
                }
            ],
            "github.com": [
                {
                    "id": "test-note-2",
                    "title": "GitHub Note",
                    "content": "This is a test note for GitHub with **bold text** and __underlined text__ and ~~strikethrough~~ and {color:#ff0000}colored text{/color}",
                    "tags": ["github", "test", "development"],
                    "createdAt": "2025-09-01T16:00:00.000Z",
                    "updatedAt": "2025-09-01T16:00:00.000Z",
                    "domain": "github.com",
                    "url": "https://github.com/example/repo",
                    "pageTitle": "Example Repository - GitHub"
                }
            ]
        };

        function testExport() {
            const format = document.getElementById('formatSelect').value;
            const output = document.getElementById('output');
            
            try {
                const exportFormats = new ExportFormats();
                const result = exportFormats.exportToFormat(sampleData, format);
                
                output.textContent = `=== ${format.toUpperCase()} EXPORT ===\n\n${result.content}`;
                
                // Also trigger download
                const blob = new Blob([result.content], { type: result.mimeType });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = result.filename;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                console.log(`Export successful: ${result.filename}`);
            } catch (error) {
                output.textContent = `Error: ${error.message}`;
                console.error('Export failed:', error);
            }
        }
    </script>
</body>
</html>
